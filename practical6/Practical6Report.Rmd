---
title: "Practical Report 6"
output:
   pdf_document: 
     keep_tex: true
     fig_caption: yes
     latex_engine: xelatex
     highlight: monochrome
   html_document:
     df_print: paged
     code_folding: hide
     highlight: monochrome
fontsize: 12pt
---

```{r setup, include = FALSE}
require(knitr)
pdf_doc <- knitr::is_latex_output()
if (pdf_doc) {opts_chunk$set(echo=FALSE, fig.align="center", out.width="60%")} else {opts_chunk$set(echo=TRUE)}
```



# Categorical Predictors {-}

In this computer practical we are considering the `Diamond` dataset.^[Chu, Singfat (2001) “Pricing the C's of Diamond Stones”, Journal of Statistics Education, 9(2). Data also available in R package Ecdat.]

<!--- Part 1: Loading the data --->
```{r, echo=FALSE}
    Diamond <- read.csv("Diamond.csv")
```
    
<!--- Part 2: Variables in the data set --->

The dataset contains information for 308 round diamonds on the following variables:

- `price`: the price of the diamond in Singapore Dollars;
- `carat`: the weight of the diamond in carat;
- `colour`: the colour purity of the diamond with levels D, E, F, G, H, I in order of decreasing purity;
- `clarity`: the clarity of the diamond with levels IF (internally flawless), VVS1, VVS2 (very, very slightly imperfect), VS1 and VS2 (very slightly imperfect);
- `certification`: body of certification with levels  GIA (Gemmological Institute of America), IGI (International Gemmological Institute) and HRD (Hoge Radd Voor Diamant).


<!--- Part 3: Structure of dataframe --->
Next we consider the dataframe `Diamond` that has been assigned the dataset.
```{r, str}
    str(Diamond)
```


<!--- Part 4: Implementing the categorical variables as factors --->

We convert the categorical variables into factors as follows:
```{r, echo=TRUE}
    Diamond$clarity <- factor(Diamond$clarity)
    # converting the other categorical variables into factors

```

<!--- Part 5: Summary of the dataset --->

```{r}
    summary(Diamond)
```

<!--- Part 6: price versus carat --->

```{r, fig.cap="A scatterplot of price against weight for the Diamond data."}
   plot(price ~ carat,  data=Diamond,  xlim=c(0, 1.15), col="navy",
          xlab="weight of diamond (in carat)", 
          ylab="price of diamond (in Singapore Dollars)")
```

<!--- Part 7 + 8: log-transforming the quantitative variables --->

```{r}
    Diamond$log_price <- log(Diamond$price)
    # log-transform carat
   
```
    

```{r, fig.cap="A scatterplot of log-price against log-weight for the Diamond data."}
    
```

<!--- Part 9 - 11: log-Price vs clarity--->

Next we explore the relationship between the log-transformed price and the factor variable `clarity` using comparative boxplots.

```{r, fig.cap="Boxplots of log-price grouped by clarity."}
    boxplot(log_price ~ clarity, data = Diamond)
```


```{r}
    levels(Diamond$clarity)
    Diamond$clarity <- factor(Diamond$clarity, c("VS2", "VS1", "VVS2", "VVS1", "IF"))
    levels(Diamond$clarity)
```

```{r fig.cap="Boxplots of log-price grouped by clarity." }
    boxplot(log_price ~ clarity, data=Diamond)
```


```{r fig.cap="Boxplots of log-weight grouped by clarity."}
    boxplot(log_carat ~ clarity, data = Diamond)
```

<!--- Part 12 - 14: log_price ~ log_c_carat + clarity --->


```{r}
    Diamond$log_c_carat <- Diamond$log_carat - log(mean(Diamond$carat))
    diamond.mlr <- lm(log_price ~ log_c_carat + clarity, data=Diamond)
    summary(diamond.mlr)
```

<!--- Part 15 - 16: log_price ~ 0 + log_c_carat + clarity --->

```{r, eval=T}
    diamond.mlr2 <- lm(log_price ~ 0 + log_c_carat + clarity, data=Diamond)
    summary(diamond.mlr2)
```
